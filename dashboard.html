<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Safvacut - Advanced Crypto Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          screens: {
            'xs': '475px',
          },
          colors: {
            primary: {
              50: '#fff7ed',
              100: '#ffedd5',
              200: '#fed7aa',
              300: '#fdba74',
              400: '#fb923c',
              500: '#f97316',
              600: '#ea580c',
              700: '#c2410c',
              800: '#9a3412',
              900: '#7c2d12',
            },
            bitcoin: '#f7931e',
            ethereum: '#627eea',
            success: '#10b981',
            danger: '#ef4444',
            warning: '#f59e0b',
          },
          animation: {
            'float': 'float 6s ease-in-out infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
            'slide-in': 'slideIn 0.3s ease-out',
            'slide-up': 'slideUp 0.3s ease-out',
            'fade-in': 'fadeIn 0.5s ease-out',
            'bounce-in': 'bounceIn 0.6s ease-out',
            'shimmer': 'shimmer 2s linear infinite',
            'gradient': 'gradient 3s ease infinite',
            'slide-right': 'slideRight 0.3s ease-out',
            'nav-bounce': 'navBounce 0.4s ease-out',
          },
          keyframes: {
            float: {
              '0%, 100%': { transform: 'translateY(0px) rotate(0deg)' },
              '50%': { transform: 'translateY(-20px) rotate(180deg)' }
            },
            glow: {
              'from': { boxShadow: '0 0 30px rgba(247, 147, 30, 0.3)' },
              'to': { boxShadow: '0 0 40px rgba(247, 147, 30, 0.6)' }
            },
            slideIn: {
              'from': { transform: 'translateX(-100%)', opacity: '0' },
              'to': { transform: 'translateX(0)', opacity: '1' }
            },
            slideUp: {
              'from': { transform: 'translateY(100%)', opacity: '0' },
              'to': { transform: 'translateY(0)', opacity: '1' }
            },
            slideRight: {
              'from': { transform: 'translateX(-100%)', opacity: '0' },
              'to': { transform: 'translateX(0)', opacity: '1' }
            },
            fadeIn: {
              'from': { opacity: '0' },
              'to': { opacity: '1' }
            },
            bounceIn: {
              '0%': { transform: 'scale(0.3)', opacity: '0' },
              '50%': { transform: 'scale(1.05)' },
              '70%': { transform: 'scale(0.9)' },
              '100%': { transform: 'scale(1)', opacity: '1' }
            },
            navBounce: {
              '0%': { transform: 'scale(0.8)', opacity: '0' },
              '50%': { transform: 'scale(1.1)' },
              '100%': { transform: 'scale(1)', opacity: '1' }
            },
            shimmer: {
              '0%': { backgroundPosition: '-200% 0' },
              '100%': { backgroundPosition: '200% 0' }
            },
            gradient: {
              '0%, 100%': { backgroundPosition: '0% 50%' },
              '50%': { backgroundPosition: '100% 50%' }
            }
          },
          fontFamily: {
            'calculator': ['Orbitron', 'monospace'],
            'balance': ['Orbitron', 'monospace'],
          }
        }
      }
    }
  </script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Orbitron:wght@400;500;600;700;800&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Inter', sans-serif;
      transition: all 0.3s ease;
      overflow-x: hidden;
    }

    .orbitron {
      font-family: 'Orbitron', monospace;
    }

    .dark-theme {
      background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 50%, #16213e 100%);
      color: #ffffff;
    }

    .dark-theme::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 20% 80%, rgba(247, 147, 30, 0.08) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(255, 107, 53, 0.08) 0%, transparent 50%);
      z-index: 1;
      pointer-events: none;
    }

    .light-theme {
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #cbd5e1 100%);
      color: #1e293b;
    }

    .glass-effect {
      backdrop-filter: blur(20px);
      transition: all 0.3s ease;
      position: relative;
      z-index: 10;
    }

    .dark .glass-effect {
      background: rgba(15, 15, 35, 0.8);
      border: 1px solid rgba(247, 147, 30, 0.2);
    }

    .light .glass-effect {
      background: rgba(255, 255, 255, 0.8);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }

    .crypto-glow {
      transition: all 0.3s ease;
    }

    .dark .crypto-glow {
      box-shadow: 0 0 30px rgba(247, 147, 30, 0.3);
    }

    .light .crypto-glow {
      box-shadow: 0 0 30px rgba(247, 147, 30, 0.15);
    }

    .btn-primary {
      background: linear-gradient(135deg, #f7931e 0%, #ff6b35 100%);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .btn-primary::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .btn-primary:hover::before {
      left: 100%;
    }

    .btn-primary:hover {
      background: linear-gradient(135deg, #e8851c 0%, #e55a2b 100%);
      transform: translateY(-2px);
      box-shadow: 0 10px 25px rgba(247, 147, 30, 0.4);
    }

    .floating-crypto {
      animation: float 6s ease-in-out infinite;
    }

    .balance-card {
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .dark .balance-card {
      background: linear-gradient(135deg, rgba(247, 147, 30, 0.1) 0%, rgba(255, 107, 53, 0.1) 100%);
    }

    .light .balance-card {
      background: linear-gradient(135deg, rgba(247, 147, 30, 0.05) 0%, rgba(255, 107, 53, 0.05) 100%);
    }

    .balance-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(247, 147, 30, 0.1), transparent);
      transition: left 0.5s;
    }

    .balance-card:hover::before {
      left: 100%;
    }

    .crypto-card {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
    }

    .crypto-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(247, 147, 30, 0.1), transparent);
      transition: left 0.5s;
    }

    .crypto-card:hover::before {
      left: 100%;
    }

    .crypto-card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: #f7931e;
    }

    .dark .crypto-card:hover {
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3), 0 0 20px rgba(247, 147, 30, 0.2);
    }

    .light .crypto-card:hover {
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1), 0 0 20px rgba(247, 147, 30, 0.15);
    }

    /* Enhanced Responsive Sidebar Styles */
    .sidebar {
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      width: 280px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
    }

    /* Desktop styles */
    @media (min-width: 1024px) {
      .sidebar {
        position: fixed;
        transform: translateX(0);
        height: 100vh;
        left: 0;
        top: 0;
        z-index: 40;
      }

      .main-content {
        margin-left: 280px;
        transition: margin-left 0.4s ease;
      }

      .mobile-menu-btn {
        display: none;
      }
    }

    /* Mobile and Tablet Responsive Styles */
    @media (max-width: 1023px) {
      .sidebar {
        position: fixed;
        transform: translateX(-100%);
        width: 100%;
        max-width: 320px;
        height: 100vh;
        z-index: 50;
        left: 0;
        top: 0;
        box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
      }

      .sidebar.sidebar-open {
        transform: translateX(0);
        animation: slideRight 0.3s ease-out;
      }

      .main-content {
        margin-left: 0;
        padding-bottom: 20px;
      }

      .mobile-menu-btn {
        display: block;
      }
    }

    /* Mobile Specific Optimizations */
    @media (max-width: 768px) {

      /* Header adjustments */
      .header-glass {
        padding: 0.75rem 1rem !important;
        height: auto !important;
      }

      .header-glass .h-14 {
        height: 3.5rem !important;
      }

      /* Main content padding */
      .section-content {
        padding: 1rem !important;
      }

      /* Balance card mobile optimization */
      .balance-card {
        padding: 1.5rem !important;
        margin-bottom: 1.5rem !important;
      }

      .balance-amount {
        font-size: 2rem !important;
        line-height: 1.2 !important;
      }

      /* Action buttons grid */
      .action-buttons {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 1rem !important;
      }

      .action-buttons button {
        padding: 1rem !important;
        min-height: 80px !important;
      }

      .action-buttons button svg {
        width: 1.5rem !important;
        height: 1.5rem !important;
        margin-bottom: 0.5rem !important;
      }

      .action-buttons button span {
        font-size: 0.875rem !important;
        font-weight: 600 !important;
      }

      /* Portfolio grid mobile */
      .portfolio-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem !important;
      }

      /* Stats grid mobile */
      .stats-grid {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 1rem !important;
      }

      .stats-grid>div {
        padding: 1.5rem 1rem !important;
        text-align: center !important;
      }

      .stats-grid .text-2xl {
        font-size: 1.5rem !important;
      }

      /* Trading grid mobile */
      .trading-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem !important;
      }

      /* Crypto items mobile */
      .crypto-item {
        padding: 1rem !important;
        border-radius: 1rem !important;
      }

      .crypto-icon {
        width: 2.5rem !important;
        height: 2.5rem !important;
        flex-shrink: 0 !important;
      }

      .crypto-text {
        font-size: 0.875rem !important;
      }

      .crypto-price {
        font-size: 0.875rem !important;
      }

      /* Transaction items mobile */
      .transaction-item {
        padding: 1rem !important;
        border-radius: 1rem !important;
      }

      .transaction-item .w-10 {
        width: 2.5rem !important;
        height: 2.5rem !important;
      }

      /* Chart container mobile */
      .chart-container {
        height: 200px !important;
        margin-top: 1rem !important;
      }

      /* Modal mobile optimization */
      .modal-content {
        margin: 1rem !important;
        padding: 1.5rem !important;
        max-height: calc(100vh - 2rem) !important;
        width: calc(100% - 2rem) !important;
        border-radius: 1rem !important;
      }

      /* Form inputs mobile */
      input,
      select,
      textarea {
        font-size: 16px !important;
        /* Prevents zoom on iOS */
        padding: 1rem !important;
        border-radius: 0.75rem !important;
      }

      /* Button improvements mobile */
      .btn-primary {
        padding: 1rem !important;
        font-size: 1rem !important;
        min-height: 48px !important;
        border-radius: 0.75rem !important;
      }

      /* Navigation improvements mobile */
      .nav-item {
        padding: 1rem !important;
        margin: 0.25rem 0 !important;
        border-radius: 0.75rem !important;
        min-height: 48px !important;
      }

      .nav-item span {
        font-size: 1rem !important;
      }

      /* User profile mobile */
      .user-profile-mobile {
        padding: 1rem !important;
      }

      /* Market overview mobile */
      #market-overview {
        grid-template-columns: repeat(2, 1fr) !important;
        gap: 1rem !important;
      }

      /* Typography mobile */
      h1 {
        font-size: 1.5rem !important;
      }

      h2 {
        font-size: 1.25rem !important;
      }

      h3 {
        font-size: 1.125rem !important;
      }

      /* Sidebar mobile specific */
      .sidebar {
        padding: 0 !important;
      }

      .sidebar>div {
        padding: 1.5rem 1rem !important;
      }

      .logo {
        font-size: 1.25rem !important;
      }

      .logo img {
        width: 35px !important;
        height: 35px !important;
      }
    }

    /* Small Mobile Devices (iPhone SE, etc.) */
    @media (max-width: 480px) {

      /* Even more compact layout */
      .section-content {
        padding: 0.75rem !important;
      }

      .balance-card {
        padding: 1rem !important;
      }

      .balance-amount {
        font-size: 1.75rem !important;
      }

      .action-buttons button {
        padding: 0.75rem !important;
        min-height: 70px !important;
      }

      .action-buttons button svg {
        width: 1.25rem !important;
        height: 1.25rem !important;
      }

      .action-buttons button span {
        font-size: 0.75rem !important;
      }

      .crypto-item {
        padding: 0.75rem !important;
      }

      .crypto-icon {
        width: 2rem !important;
        height: 2rem !important;
      }

      .stats-grid>div {
        padding: 1rem !important;
      }

      .stats-grid .text-2xl {
        font-size: 1.25rem !important;
      }

      .modal-content {
        margin: 0.5rem !important;
        padding: 1rem !important;
      }

      .chart-container {
        height: 150px !important;
      }

      /* Ultra compact navigation */
      .nav-item {
        padding: 0.75rem !important;
      }

      .nav-item span {
        font-size: 0.875rem !important;
      }

      .sidebar>div {
        padding: 1rem !important;
      }
    }

    /* Enhanced Mobile Menu Button */
    .mobile-menu-btn {
      display: none;
      position: relative;
      padding: 12px;
      border-radius: 12px;
      background: rgba(247, 147, 30, 0.1);
      border: 1px solid rgba(247, 147, 30, 0.2);
      color: #f7931e;
      transition: all 0.3s ease;
      backdrop-filter: blur(10px);
      min-width: 44px;
      min-height: 44px;
    }

    .mobile-menu-btn:hover {
      background: rgba(247, 147, 30, 0.2);
      border-color: rgba(247, 147, 30, 0.4);
      transform: scale(1.05);
    }

    .mobile-menu-btn:active {
      transform: scale(0.95);
    }

    /* Enhanced Mobile Menu Overlay */
    .mobile-menu-overlay {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.6);
      backdrop-filter: blur(8px);
      z-index: 40;
      opacity: 0;
      visibility: hidden;
    }

    .mobile-menu-overlay.active {
      opacity: 1;
      visibility: visible;
    }

    /* Enhanced Navigation Items */
    .nav-item {
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      position: relative;
      overflow: hidden;
      border-radius: 12px;
      margin: 2px 0;
      min-height: 44px;
      display: flex;
      align-items: center;
    }

    .nav-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(247, 147, 30, 0.1), transparent);
      transition: left 0.5s;
    }

    .nav-item:hover::before {
      left: 100%;
    }

    .nav-item:hover {
      background: rgba(247, 147, 30, 0.1);
      transform: translateX(4px);
      border-left: 3px solid #f7931e;
      padding-left: 9px;
    }

    .nav-item.active {
      background: linear-gradient(135deg, rgba(247, 147, 30, 0.2) 0%, rgba(255, 107, 53, 0.1) 100%);
      color: #f7931e;
      border-left: 3px solid #f7931e;
      padding-left: 9px;
      box-shadow: 0 4px 12px rgba(247, 147, 30, 0.2);
    }

    .nav-item.active svg {
      filter: drop-shadow(0 2px 4px rgba(247, 147, 30, 0.3));
    }

    /* Enhanced Logo */
    .logo {
      font-family: 'Orbitron', monospace;
      font-size: 1.5rem;
      font-weight: 700;
      color: #f7931e;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      transition: all 0.3s ease;
      padding: 8px;
      border-radius: 12px;
    }

    .logo:hover {
      transform: scale(1.05);
      background: rgba(247, 147, 30, 0.1);
    }

    .logo img {
      height: 40px;
      width: 40px;
      object-fit: contain;
      border-radius: 8px;
      transition: all 0.3s ease;
      filter: drop-shadow(0 0 10px rgba(247, 147, 30, 0.3));
    }

    .logo img:hover {
      filter: drop-shadow(0 0 15px rgba(247, 147, 30, 0.5));
      transform: rotate(5deg);
    }

    /* Enhanced Header */
    .header-glass {
      backdrop-filter: blur(25px);
      border-bottom: 1px solid rgba(247, 147, 30, 0.2);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
    }

    .dark .header-glass {
      background: rgba(15, 15, 35, 0.9);
    }

    .light .header-glass {
      background: rgba(255, 255, 255, 0.9);
    }

    /* Notification dot animation */
    .notification-dot {
      position: absolute;
      top: -2px;
      right: -2px;
      width: 8px;
      height: 8px;
      background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
      border-radius: 50%;
      animation: pulse 2s infinite;
      box-shadow: 0 0 8px rgba(239, 68, 68, 0.6);
    }

    /* Loading and transition states */
    .loading-skeleton {
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
      background-size: 200% 100%;
      animation: shimmer 2s infinite;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      z-index: 1000;
      animation: fadeIn 0.3s ease-out;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    .modal-content {
      border-radius: 20px;
      padding: 2rem;
      max-width: 500px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      animation: bounceIn 0.6s ease-out;
    }

    .dark .modal-content {
      background: rgba(15, 15, 35, 0.95);
      border: 1px solid rgba(247, 147, 30, 0.2);
      color: #ffffff;
    }

    .light .modal-content {
      background: rgba(255, 255, 255, 0.95);
      border: 1px solid rgba(0, 0, 0, 0.1);
      color: #1e293b;
    }

    .qr-container {
      display: flex;
      justify-content: center;
      margin: 1.5rem 0;
    }

    .status-completed {
      background: rgba(16, 185, 129, 0.2);
      color: #10b981;
    }

    .status-pending {
      background: rgba(245, 158, 11, 0.2);
      color: #f59e0b;
    }

    .status-failed {
      background: rgba(239, 68, 68, 0.2);
      color: #ef4444;
    }

    .pulse-glow {
      animation: glow 2s ease-in-out infinite alternate;
    }

    .gradient-text {
      background: linear-gradient(135deg, #f7931e 0%, #ff6b35 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .crypto-icon-bitcoin {
      background: linear-gradient(135deg, #f7931e 0%, #ff6b35 100%);
    }

    .crypto-icon-ethereum {
      background: linear-gradient(135deg, #627eea 0%, #3c3c3d 100%);
    }

    .crypto-icon-bnb {
      background: linear-gradient(135deg, #f0b90b 0%, #f8d12f 100%);
    }

    .crypto-icon-usdt {
      background: linear-gradient(135deg, #26a17b 0%, #50af95 100%);
    }

    .crypto-icon-solana {
      background: linear-gradient(135deg, #9945ff 0%, #14f195 100%);
    }

    .crypto-icon-doge {
      background: linear-gradient(135deg, #c2a633 0%, #d4af37 100%);
    }

    .transaction-item {
      transition: all 0.3s ease;
    }

    .transaction-item:hover {
      transform: translateX(5px);
    }

    .dark .transaction-item:hover {
      background: rgba(255, 255, 255, 0.05);
    }

    .light .transaction-item:hover {
      background: rgba(0, 0, 0, 0.05);
    }

    .price-up {
      color: #10b981;
    }

    .price-down {
      color: #ef4444;
    }

    .price-neutral {
      color: #6b7280;
    }

    .loading-spinner {
      border: 2px solid rgba(247, 147, 30, 0.3);
      border-top: 2px solid #f7931e;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to {
        transform: rotate(360deg);
      }
    }

    .ripple {
      position: absolute;
      border-radius: 50%;
      background: rgba(247, 147, 30, 0.3);
      transform: scale(0);
      animation: ripple 0.6s linear;
      pointer-events: none;
    }

    @keyframes ripple {
      to {
        transform: scale(4);
        opacity: 0;
      }
    }

    /* Touch-friendly buttons for mobile */
    @media (hover: none) and (pointer: coarse) {
      .crypto-card:hover {
        transform: none;
      }

      .btn-primary:hover {
        transform: none;
      }

      button,
      .nav-item {
        min-height: 44px;
        min-width: 44px;
      }

      .nav-item:hover {
        transform: none;
        background: rgba(247, 147, 30, 0.1);
      }
    }

    /* Focus states for accessibility */
    button:focus,
    .nav-item:focus,
    input:focus,
    select:focus,
    textarea:focus {
      outline: 2px solid #f7931e;
      outline-offset: 2px;
    }

    /* Smooth scrolling */
    html {
      scroll-behavior: smooth;
    }

    /* Custom scrollbar for sidebar */
    .sidebar::-webkit-scrollbar {
      width: 4px;
    }

    .sidebar::-webkit-scrollbar-track {
      background: rgba(247, 147, 30, 0.1);
    }

    .sidebar::-webkit-scrollbar-thumb {
      background: rgba(247, 147, 30, 0.5);
      border-radius: 2px;
    }

    .sidebar::-webkit-scrollbar-thumb:hover {
      background: rgba(247, 147, 30, 0.7);
    }

    /* Balance and Calculator Fonts */
    .balance-amount {
      font-family: 'Orbitron', monospace !important;
      font-weight: 700;
    }

    .calculator-font {
      font-family: 'Orbitron', monospace !important;
    }

    /* Landscape mobile adjustments */
    @media (max-width: 768px) and (orientation: landscape) {
      .balance-card {
        padding: 1rem !important;
      }

      .balance-amount {
        font-size: 1.5rem !important;
      }

      .action-buttons {
        grid-template-columns: repeat(4, 1fr) !important;
      }

      .stats-grid {
        grid-template-columns: repeat(4, 1fr) !important;
      }

      .chart-container {
        height: 120px !important;
      }
    }

    /* Safe area adjustments for notched devices */
    @supports (padding: max(0px)) {
      .sidebar {
        padding-left: max(1rem, env(safe-area-inset-left));
        padding-right: max(1rem, env(safe-area-inset-right));
      }

      .header-glass {
        padding-top: max(0.5rem, env(safe-area-inset-top));
      }

      .main-content {
        padding-bottom: max(1rem, env(safe-area-inset-bottom));
      }
    }

    /* Mobile-specific improvements for better UX */
    @media (max-width: 768px) {

      /* Prevent horizontal scroll */
      body {
        overflow-x: hidden;
      }

      /* Better touch targets */
      .action-buttons button,
      .nav-item,
      .btn-primary {
        -webkit-tap-highlight-color: rgba(247, 147, 30, 0.2);
      }

      /* Improved modal behavior on mobile */
      .modal {
        padding: 0.5rem;
      }

      /* Better form spacing on mobile */
      .form-group {
        margin-bottom: 1.5rem;
      }

      /* Improved card spacing */
      .glass-effect {
        margin-bottom: 1rem;
      }

      /* Better button spacing */
      .flex.gap-3 {
        gap: 1rem !important;
      }

      /* Improved text readability */
      .text-xs {
        font-size: 0.875rem !important;
      }

      .text-sm {
        font-size: 1rem !important;
      }
    }
  </style>
</head>

<body class="dark dark-theme">
  <!-- Mobile Menu Overlay -->
  <div id="mobile-overlay" class="mobile-menu-overlay"></div>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar glass-effect">
    <div class="p-4 sm:p-6 h-full flex flex-col">
      <!-- Logo -->
      <div class="flex items-center space-x-3 mb-6 sm:mb-8">
        <a href="index.html" class="logo">
          <img src="/Public/mainl-logo.png" alt="Safvacut Logo" id="logoImg" />
          <span class="hidden sm:inline">SAFVACUT</span>
        </a>
      </div>

      <!-- Navigation -->
      <nav class="space-y-1 sm:space-y-2 flex-1">
        <a href="#dashboard" class="nav-item active flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="dashboard">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2v0"></path>
          </svg>
          <span class="text-sm sm:text-base">Dashboard</span>
        </a>
        <a href="#portfolio" class="nav-item flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="portfolio">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
            </path>
          </svg>
          <span class="text-sm sm:text-base">Portfolio</span>
        </a>
        <a href="#trading" class="nav-item flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="trading">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6">
            </path>
          </svg>
          <span class="text-sm sm:text-base">Trading</span>
        </a>
        <a href="#transactions" class="nav-item flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="transactions">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
          </svg>
          <span class="text-sm sm:text-base">Transactions</span>
          <div class="notification-dot"></div>
        </a>
        <a href="#staking" class="nav-item flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="staking">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1">
            </path>
          </svg>
          <span class="text-sm sm:text-base">Staking</span>
        </a>
        <a href="#settings" class="nav-item flex items-center space-x-3 p-3 rounded-lg transition-all"
          data-section="settings">
          <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z">
            </path>
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z">
            </path>
          </svg>
          <span class="text-sm sm:text-base">Settings</span>
        </a>
      </nav>

      <!-- User Profile -->
      <div class="mt-auto">
        <div class="glass-effect rounded-xl p-3 sm:p-4 user-profile-mobile">
          <div class="flex items-center space-x-3">
            <img id="user-avatar" src="/Public/mainl-logo.png"
              class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex-shrink-0">
            <div class="flex-1 min-w-0">
              <p id="user-name" class="text-xs sm:text-sm font-medium truncate">Loading...</p>
              <p id="user-email" class="text-xs text-gray-400 truncate">Loading...</p>
            </div>
            <button id="logout-btn"
              class="p-2 rounded-lg hover:bg-red-500 hover:bg-opacity-20 transition-all flex-shrink-0"
              aria-label="Logout">
              <svg class="w-4 h-4 text-red-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content -->
  <main id="main-content" class="main-content min-h-screen">
    <!-- Header -->
    <header class="header-glass sticky top-0 z-30">
      <div class="px-3 sm:px-4 lg:px-8">
        <div class="flex items-center justify-between h-14 sm:h-16">
          <!-- Mobile Menu Button -->
          <button id="mobile-menu-btn" class="mobile-menu-btn lg:hidden" aria-label="Toggle sidebar">
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
            </svg>
          </button>

          <!-- Header Actions -->
          <div class="flex items-center space-x-2 sm:space-x-4 ml-auto">
            <!-- Theme Toggle -->
            <button id="theme-toggle" class="p-2 rounded-lg hover:bg-orange-500 hover:bg-opacity-20 transition-all"
              aria-label="Toggle theme">
              <svg id="theme-icon-dark" class="w-4 h-4 sm:w-5 sm:h-5 hidden" fill="none" stroke="currentColor"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
              </svg>
              <svg id="theme-icon-light" class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor"
                viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z">
                </path>
              </svg>
            </button>

            <!-- Notifications -->
            <button class="p-2 rounded-lg hover:bg-orange-500 hover:bg-opacity-20 transition-all relative"
              aria-label="View notifications">
              <svg class="w-4 h-4 sm:w-5 sm:h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 17h5l-5 5v-5zM10.07 2.82a3 3 0 00-4.24 0L2.82 5.83a3 3 0 000 4.24L5.83 13.1a3 3 0 004.24 0l3.01-3.01a3 3 0 000-4.24L10.07 2.82z">
                </path>
              </svg>
              <div class="notification-dot"></div>
            </button>

            <!-- Quick Actions -->
            <div class="hidden sm:flex items-center space-x-2">
              <button onclick="showSendModal()"
                class="btn-primary px-3 sm:px-4 py-2 rounded-lg text-white font-medium text-xs sm:text-sm">
                <svg class="w-3 h-3 sm:w-4 sm:h-4 mr-1 sm:mr-2 inline" fill="none" stroke="currentColor"
                  viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8l-8-8-8 8">
                  </path>
                </svg>
                Receive
              </button>
            </div>
          </div>
        </div>
    </header>

    <!-- Dashboard Content -->
    <div id="dashboard-section" class="section-content p-3 sm:p-4 lg:p-8">
      <!-- Balance Card -->
      <div class="balance-card glass-effect rounded-2xl sm:rounded-3xl p-4 sm:p-6 lg:p-8 mb-6 sm:mb-8 crypto-glow">
        <div class="flex flex-col space-y-4 sm:space-y-0 sm:flex-row sm:items-center sm:justify-between mb-4 sm:mb-6">
          <div class="flex-1">
            <!-- Welcome Message -->
            <div class="mb-3 sm:mb-4">
              <h1 class="text-lg sm:text-xl font-semibold">Welcome back, <span id="header-user-name"
                  class="gradient-text">User</span>!</h1>
              <p class="text-xs sm:text-sm text-gray-400">Manage your crypto portfolio with confidence</p>
            </div>
            <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold balance-amount mb-2">
              $<span id="total-balance">0.00</span>
            </h2>
            <p class="text-gray-400 text-sm sm:text-base">Total Portfolio Value</p>
            <div class="flex items-center mt-2">
              <span id="balance-change" class="text-xs sm:text-sm font-medium price-up">+$1,234.56 (+2.34%)</span>
              <span class="text-xs text-gray-500 ml-2">24h</span>
            </div>
          </div>
          <div class="w-full sm:w-1/2 lg:w-1/3">
            <div class="chart-container">
              <canvas id="portfolio-chart"></canvas>
            </div>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="action-buttons grid grid-cols-2 sm:grid-cols-4 gap-2 sm:gap-3">
          <button onclick="showSendModal()"
            class="flex flex-col items-center p-3 sm:p-4 glass-effect rounded-xl hover:bg-orange-500 hover:bg-opacity-20 transition-all">
            <svg class="w-5 h-5 sm:w-6 sm:h-6 mb-2 text-orange-500" fill="none" stroke="currentColor"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path>
            </svg>
            <span class="text-xs sm:text-sm font-medium">Send</span>
          </button>
          <button onclick="showReceiveModal()"
            class="flex flex-col items-center p-3 sm:p-4 glass-effect rounded-xl hover:bg-green-500 hover:bg-opacity-20 transition-all">
            <svg class="w-5 h-5 sm:w-6 sm:h-6 mb-2 text-green-500" fill="none" stroke="currentColor"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8l-8-8-8 8"></path>
            </svg>
            <span class="text-xs sm:text-sm font-medium">Receive</span>
          </button>
          <button onclick="showBuyModal()"
            class="flex flex-col items-center p-3 sm:p-4 glass-effect rounded-xl hover:bg-blue-500 hover:bg-opacity-20 transition-all">
            <svg class="w-5 h-5 sm:w-6 sm:h-6 mb-2 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path>
            </svg>
            <span class="text-xs sm:text-sm font-medium">Buy</span>
          </button>
          <button onclick="showSwapModal()"
            class="flex flex-col items-center p-3 sm:p-4 glass-effect rounded-xl hover:bg-purple-500 hover:bg-opacity-20 transition-all">
            <svg class="w-5 h-5 sm:w-6 sm:h-6 mb-2 text-purple-500" fill="none" stroke="currentColor"
              viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path>
            </svg>
            <span class="text-xs sm:text-sm font-medium">Swap</span>
          </button>
        </div>
      </div>

      <!-- Portfolio Grid -->
      <div class="portfolio-grid grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
        <!-- Assets -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <div class="flex items-center justify-between mb-4 sm:mb-6">
            <h3 class="text-lg sm:text-xl font-semibold">Your Assets</h3>
            <button class="text-orange-500 hover:text-orange-400 text-xs sm:text-sm font-medium">View All</button>
          </div>
          <div id="assets-list" class="space-y-3 sm:space-y-4">
            <!-- Assets will be loaded here -->
          </div>
        </div>

        <!-- Recent Transactions -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <div class="flex items-center justify-between mb-4 sm:mb-6">
            <h3 class="text-lg sm:text-xl font-semibold">Recent Activity</h3>
            <button class="text-orange-500 hover:text-orange-400 text-xs sm:text-sm font-medium">View All</button>
          </div>
          <div id="transactions-list" class="space-y-3 sm:space-y-4">
            <!-- Transactions will be loaded here -->
          </div>
        </div>
      </div>

      <!-- Market Overview -->
      <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
        <div class="flex items-center justify-between mb-4 sm:mb-6">
          <h3 class="text-lg sm:text-xl font-semibold">Market Overview</h3>
          <div class="flex items-center space-x-1 sm:space-x-2">
            <button
              class="text-xs sm:text-sm px-2 sm:px-3 py-1 rounded-lg bg-orange-500 bg-opacity-20 text-orange-500">24H</button>
            <button
              class="text-xs sm:text-sm px-2 sm:px-3 py-1 rounded-lg hover:bg-orange-500 hover:bg-opacity-20 transition-all">7D</button>
            <button
              class="text-xs sm:text-sm px-2 sm:px-3 py-1 rounded-lg hover:bg-orange-500 hover:bg-opacity-20 transition-all">30D</button>
          </div>
        </div>
        <div id="market-overview" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
          <!-- Market data will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Portfolio Section -->
    <div id="portfolio-section" class="section-content hidden p-3 sm:p-4 lg:p-8">
      <div class="mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-2">Portfolio Analytics</h2>
        <p class="text-gray-400 text-sm sm:text-base">Detailed view of your cryptocurrency holdings and performance</p>
      </div>

      <!-- Portfolio Stats -->
      <div class="stats-grid grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-6 mb-6 sm:mb-8">
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">$52,847.32</div>
          <div class="text-xs sm:text-sm text-gray-400">Total Value</div>
          <div class="text-xs sm:text-sm text-green-500 mt-1">+12.34%</div>
        </div>
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">+$6,234.12</div>
          <div class="text-xs sm:text-sm text-gray-400">24h P&L</div>
          <div class="text-xs sm:text-sm text-green-500 mt-1">+13.45%</div>
        </div>
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">8</div>
          <div class="text-xs sm:text-sm text-gray-400">Assets</div>
          <div class="text-xs sm:text-sm text-blue-500 mt-1">Diversified</div>
        </div>
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">67.8%</div>
          <div class="text-xs sm:text-sm text-gray-400">Success Rate</div>
          <div class="text-xs sm:text-sm text-green-500 mt-1">Above Average</div>
        </div>
      </div>

      <!-- Detailed Portfolio -->
      <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
        <h3 class="text-lg sm:text-xl font-semibold mb-4 sm:mb-6">Asset Allocation</h3>
        <div id="portfolio-assets-list" class="space-y-3 sm:space-y-4">
          <!-- Portfolio items will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Trading Section -->
    <div id="trading-section" class="section-content hidden p-3 sm:p-4 lg:p-8">
      <div class="mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-2">Trading Terminal</h2>
        <p class="text-gray-400 text-sm sm:text-base">Advanced trading tools and real-time market data</p>
      </div>

      <!-- Trading Interface -->
      <div class="trading-grid grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-6">
        <!-- Order Book -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <h3 class="text-base sm:text-lg font-semibold mb-4">Order Book</h3>
          <div class="space-y-2">
            <div class="flex justify-between text-xs text-gray-400 mb-2">
              <span>Price (USD)</span>
              <span>Amount (BTC)</span>
            </div>
            <div id="order-book-sells"></div>
            <div class="text-center font-bold text-base sm:text-lg text-orange-500 py-2 calculator-font">45234.90</div>
            <div id="order-book-buys"></div>
          </div>
        </div>

        <!-- Trading Form -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <h3 class="text-base sm:text-lg font-semibold mb-4">Place Order</h3>
          <form class="space-y-4">
            <div class="flex space-x-2">
              <button type="button"
                class="flex-1 py-2 px-4 bg-green-500 bg-opacity-20 text-green-500 rounded-lg text-sm">Buy</button>
              <button type="button"
                class="flex-1 py-2 px-4 bg-red-500 bg-opacity-20 text-red-500 rounded-lg text-sm">Sell</button>
            </div>
            <div>
              <label for="amount" class="block text-sm font-medium mb-2">Amount</label>
              <input type="number" id="amount" class="w-full p-3 glass-effect rounded-lg border border-gray-600 
              class=" w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500
                focus:outline-none calculator-font text-sm sm:text-base" placeholder="0.00">
            </div>
            <div>
              <label for="price" class="block text-sm font-medium mb-2">Price</label>
              <input type="number" id="price"
                class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none calculator-font text-sm sm:text-base"
                placeholder="0.00">
            </div>
            <button type="submit" class="btn-primary w-full py-3 rounded-lg font-semibold text-sm sm:text-base">Place
              Order</button>
          </form>
        </div>

        <!-- Recent Trades -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <h3 class="text-base sm:text-lg font-semibold mb-4">Recent Trades</h3>
          <div class="space-y-2">
            <div class="flex justify-between text-xs text-gray-400 mb-2">
              <span>Time</span>
              <span>Price</span>
              <span>Amount</span>
            </div>
            <div id="recent-trades-list"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Transactions Section -->
    <div id="transactions-section" class="section-content hidden p-3 sm:p-4 lg:p-8">
      <div class="mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-2">Transaction History</h2>
        <p class="text-gray-400 text-sm sm:text-base">Complete record of all your cryptocurrency transactions</p>
      </div>

      <!-- Transaction Filters -->
      <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 mb-4 sm:mb-6">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4">
          <select id="transaction-type-filter"
            class="p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option value="All Types">All Types</option>
            <option value="send">Send</option>
            <option value="receive">Receive</option>
            <option value="buy">Buy</option>
            <option value="sell">Sell</option>
            <option value="swap">Swap</option>
            <option value="stake">Stake</option>
          </select>
          <select id="transaction-asset-filter"
            class="p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option value="All Assets">All Assets</option>
            <option value="BTC">Bitcoin</option>
            <option value="ETH">Ethereum</option>
            <option value="BNB">BNB</option>
            <option value="USDT">Tether</option>
            <option value="SOL">Solana</option>
            <option value="DOGE">Dogecoin</option>
          </select>
          <input type="date" id="transaction-date-filter"
            class="p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
          <button id="filter-transactions-btn"
            class="btn-primary py-3 rounded-lg font-semibold text-sm sm:text-base">Filter</button>
        </div>
      </div>

      <!-- Transaction List -->
      <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
        <div id="transaction-history" class="space-y-3 sm:space-y-4">
          <!-- Transaction history will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Staking Section -->
    <div id="staking-section" class="section-content hidden p-3 sm:p-4 lg:p-8">
      <div class="mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-2">Staking Rewards</h2>
        <p class="text-gray-400 text-sm sm:text-base">Earn passive income by staking your cryptocurrencies</p>
      </div>

      <!-- Staking Overview -->
      <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 sm:gap-6 mb-6 sm:mb-8">
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">$12,847.32</div>
          <div class="text-xs sm:text-sm text-gray-400">Total Staked</div>
          <div class="text-xs sm:text-sm text-green-500 mt-1">+5.67% APY</div>
        </div>
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">$234.12</div>
          <div class="text-xs sm:text-sm text-gray-400">Rewards Earned</div>
          <div class="text-xs sm:text-sm text-green-500 mt-1">This Month</div>
        </div>
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6 text-center">
          <div class="text-lg sm:text-2xl font-bold calculator-font mb-2">4</div>
          <div class="text-xs sm:text-sm text-gray-400">Active Stakes</div>
          <div class="text-xs sm:text-sm text-blue-500 mt-1">Validators</div>
        </div>
      </div>

      <!-- Available Staking Options -->
      <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
        <h3 class="text-lg sm:text-xl font-semibold mb-4 sm:mb-6">Available Staking Options</h3>
        <div id="staking-options-list" class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
          <!-- Staking options will be loaded here -->
        </div>
      </div>
    </div>

    <!-- Settings Section -->
    <div id="settings-section" class="section-content hidden p-3 sm:p-4 lg:p-8">
      <div class="mb-6 sm:mb-8">
        <h2 class="text-xl sm:text-2xl font-bold mb-2">Account Settings</h2>
        <p class="text-gray-400 text-sm sm:text-base">Manage your account preferences and security settings</p>
      </div>

      <!-- Settings Grid -->
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6">
        <!-- Profile Settings -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <h3 class="text-base sm:text-lg font-semibold mb-4">Profile Information</h3>
          <form id="profile-settings-form" class="space-y-4">
            <div>
              <label for="settings-name" class="block text-sm font-medium mb-2">Display Name</label>
              <input type="text" id="settings-name"
                class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            </div>
            <div>
              <label for="settings-email" class="block text-sm font-medium mb-2">Email Address</label>
              <input type="email" id="settings-email"
                class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base"
                readonly>
            </div>
            <button type="submit"
              class="btn-primary px-4 sm:px-6 py-3 rounded-lg font-semibold text-sm sm:text-base">Update
              Profile</button>
          </form>
        </div>

        <!-- Security Settings -->
        <div class="glass-effect rounded-xl sm:rounded-2xl p-4 sm:p-6">
          <h3 class="text-base sm:text-lg font-semibold mb-4">Security</h3>
          <div class="space-y-4">
            <div class="flex items-center justify-between p-3 sm:p-4 glass-effect rounded-lg">
              <div>
                <div class="font-medium text-sm sm:text-base">Two-Factor Authentication</div>
                <div class="text-xs sm:text-sm text-gray-400">Add an extra layer of security</div>
              </div>
              <button
                class="bg-green-500 bg-opacity-20 text-green-500 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm">Enabled</button>
            </div>
            <div class="flex items-center justify-between p-3 sm:p-4 glass-effect rounded-lg">
              <div>
                <div class="font-medium text-sm sm:text-base">Email Notifications</div>
                <div class="text-xs sm:text-sm text-gray-400">Receive transaction alerts</div>
              </div>
              <button
                class="bg-orange-500 bg-opacity-20 text-orange-500 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm">Configure</button>
            </div>
            <div class="flex items-center justify-between p-3 sm:p-4 glass-effect rounded-lg">
              <div>
                <div class="font-medium text-sm sm:text-base">API Access</div>
                <div class="text-xs sm:text-sm text-gray-400">Manage API keys</div>
              </div>
              <button
                class="bg-blue-500 bg-opacity-20 text-blue-500 px-3 sm:px-4 py-2 rounded-lg text-xs sm:text-sm">Manage</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Modals -->
  <!-- Send Modal -->
  <div id="send-modal" class="modal">
    <div class="modal-content glass-effect">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
        <h3 class="text-lg sm:text-2xl font-bold orbitron">Send Cryptocurrency</h3>
        <button class="close-modal p-2 rounded-lg hover:bg-gray-700 transition-colors" aria-label="Close modal">
          <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form class="space-y-4">
        <div class="text-center">
          <img id="send-crypto-logo" src="mainl-logo.png" alt="Crypto Logo"
            class="w-20 h-20 mx-auto mb-4 rounded-full shadow-lg border-2 border-orange-500" />
        </div>
        <div>
          <label for="send-asset" class="block text-sm font-medium mb-2">Select Asset</label>
          <select id="send-asset"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option value="btc">Bitcoin (BTC)</option>
            <option value="eth">Ethereum (ETH)</option>
            <option value="trx">Tron (TRX)</option>
            <option value="usdt_ethereum">USDT Ethereum (USDT_ETH)</option>
            <option value="usdt_tron">USDT_Tron (USDT_TRON)</option>
          </select>
        </div>
        <div>
          <label for="send-address" class="block text-sm font-medium mb-2">Recipient Address</label>
          <input type="text" id="send-address"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base"
            placeholder="Enter wallet address">
        </div>
        <div>
          <label for="send-amount" class="block text-sm font-medium mb-2">Amount</label>
          <input type="number" id="send-amount"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none calculator-font text-sm sm:text-base"
            placeholder="0.00">
        </div>
        <div class="flex flex-col sm:flex-row gap-3">
          <button type="button"
            class="close-modal flex-1 py-3 glass-effect rounded-lg font-semibold text-sm sm:text-base">Cancel</button>
          <button type="submit" class="btn-primary flex-1 py-3 rounded-lg font-semibold text-sm sm:text-base">Send
            Now</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Receive Modal -->
  <div id="receive-modal" class="modal">
    <div class="modal-content glass-effect">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
        <h3 class="text-lg sm:text-2xl font-bold orbitron">Receive Cryptocurrency</h3>
        <button class="close-modal p-2 rounded-lg hover:bg-gray-700 transition-colors" aria-label="Close modal">
          <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <div class="text-center">
        <div class="mb-4">
          <img id="receive-crypto-logo" src="mainl-logo.png" alt="Crypto Logo"
            class="w-20 h-20 mx-auto mb-4 rounded-full shadow-lg border-2 border-orange-500" />
          <label for="receive-asset" class="block text-sm font-medium mb-2">Select Asset</label>
          <select id="receive-asset"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option value="btc">Bitcoin (BTC)</option>
            <option value="eth">Ethereum (ETH)</option>
            <option value="trx">Tron (TRX)</option>
            <option value="usdt_ethereum">USDT Ethereum (USDT_ETH)</option>
            <option value="usdt_tron">USDT_Tron (USDT_TRON)</option>
          </select>
        </div>
        <div class="qr-container">
          <canvas id="receive-qr"></canvas>
        </div>
        <div id="receive-address" class="bg-gray-800 p-3 sm:p-4 rounded-lg mt-4 break-all font-mono text-xs sm:text-sm">
        </div>
        <div class="flex flex-col sm:flex-row gap-3 mt-4 sm:mt-6">
          <button id="copy-address" class="btn-primary flex-1 py-3 rounded-lg font-semibold text-sm sm:text-base">
            <svg class="w-4 h-4 sm:w-5 sm:h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z">
              </path>
            </svg>
            Copy Address
          </button>
          <button id="share-address" class="glass-effect flex-1 py-3 rounded-lg font-semibold text-sm sm:text-base">
            <svg class="w-4 h-4 sm:w-5 sm:h-5 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z">
              </path>
            </svg>
            Share
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Buy Modal -->
  <div id="buy-modal" class="modal">
    <div class="modal-content glass-effect">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
        <h3 class="text-lg sm:text-2xl font-bold orbitron">Buy Cryptocurrency</h3>
        <button class="close-modal p-2 rounded-lg hover:bg-gray-700 transition-colors" aria-label="Close modal">
          <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form class="space-y-4">
        <div>
          <label for="buy-crypto" class="block text-sm font-medium mb-2">Select Cryptocurrency</label>
          <select id="buy-crypto"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option>Bitcoin (BTC)</option>
            <option>Ethereum (ETH)</option>
            <option>BNB (BNB)</option>
          </select>
        </div>
        <div>
          <label for="buy-amount-usd" class="block text-sm font-medium mb-2">Amount (USD)</label>
          <input type="number" id="buy-amount-usd"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none calculator-font text-sm sm:text-base"
            placeholder="100.00">
        </div>
        <div>
          <label for="payment-method" class="block text-sm font-medium mb-2">Payment Method</label>
          <select id="payment-method"
            class="w-full p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
            <option>Credit/Debit Card</option>
            <option>Bank Transfer</option>
            <option>PayPal</option>
          </select>
        </div>
        <div class="flex flex-col sm:flex-row gap-3">
          <button type="button"
            class="close-modal flex-1 py-3 glass-effect rounded-lg font-semibold text-sm sm:text-base">Cancel</button>
          <button type="submit" class="btn-primary flex-1 py-3 rounded-lg font-semibold text-sm sm:text-base">Buy
            Now</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Swap Modal -->
  <div id="swap-modal" class="modal">
    <div class="modal-content glass-effect">
      <div class="flex items-center justify-between mb-4 sm:mb-6">
        <h3 class="text-lg sm:text-2xl font-bold orbitron">Swap Cryptocurrency</h3>
        <button class="close-modal p-2 rounded-lg hover:bg-gray-700 transition-colors" aria-label="Close modal">
          <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <form class="space-y-4">
        <div>
          <label for="swap-from-asset" class="block text-sm font-medium mb-2">From</label>
          <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
            <select id="swap-from-asset"
              class="flex-1 p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
              <option>Bitcoin (BTC)</option>
              <option>Ethereum (ETH)</option>
              <option>BNB (BNB)</option>
            </select>
            <input type="number" id="swap-from-amount"
              class="flex-1 p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none calculator-font text-sm sm:text-base"
              placeholder="0.00">
          </div>
        </div>
        <div class="flex justify-center">
          <button type="button"
            class="p-2 rounded-full glass-effect hover:bg-orange-500 hover:bg-opacity-20 transition-all"
            aria-label="Swap direction">
            <svg class="w-5 h-5 sm:w-6 sm:h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M7 16V4m0 0L3 8m4-4l4 4m6 0v12m0 0l4-4m-4 4l-4-4"></path>
            </svg>
          </button>
        </div>
        <div>
          <label for="swap-to-asset" class="block text-sm font-medium mb-2">To</label>
          <div class="flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
            <select id="swap-to-asset"
              class="flex-1 p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none text-sm sm:text-base">
              <option>Ethereum (ETH)</option>
              <option>Bitcoin (BTC)</option>
              <option>BNB (BNB)</option>
            </select>
            <input type="number" id="swap-to-amount"
              class="flex-1 p-3 glass-effect rounded-lg border border-gray-600 focus:border-orange-500 focus:outline-none calculator-font text-sm sm:text-base"
              placeholder="0.00" readonly>
          </div>
        </div>
        <div class="glass-effect rounded-lg p-3 sm:p-4">
          <div class="flex justify-between text-xs sm:text-sm">
            <span>Exchange Rate</span>
            <span class="calculator-font">1 BTC = 16.25 ETH</span>
          </div>
          <div class="flex justify-between text-xs sm:text-sm mt-2">
            <span>Network Fee</span>
            <span class="calculator-font">~$2.50</span>
          </div>
        </div>
        <div class="flex flex-col sm:flex-row gap-3">
          <button type="button"
            class="close-modal flex-1 py-3 glass-effect rounded-lg font-semibold text-sm sm:text-base">Cancel</button>
          <button type="submit"
            class="btn-primary flex-1 py-3 rounded-lg font-semibold text-sm sm:text-base">Swap</button>
        </div>
      </form>
    </div>
  </div>

  <script type="module">
    // Firebase Config
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import {
      getAuth,
      onAuthStateChanged,
      signOut,
      updateProfile as firebaseUpdateProfile
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import {
      getFirestore,
      doc,
      getDoc,
      updateDoc,
      serverTimestamp
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyD6enbTO-nNYVyrNLRP-Av6ghguL3--Nvw",
      authDomain: "safvacut-web-wallet.firebaseapp.com",
      projectId: "safvacut-web-wallet",
      storageBucket: "safvacut-web-wallet.appspot.com",
      messagingSenderId: "976916444641",
      appId: "1:976916444641:web:4c6a6ad09c43a7ccda0ea0",
      measurementId: "G-0QCL2TQCB6"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    let currentUser = null;
    let userProfile = null;
    let portfolioChartInstance = null;

    // Wallet addresses for different cryptocurrencies
    const walletAddresses = {
      btc: 'TZ359zm5ixt1LcwSVZNErBGqqJujBhiX8e',
      eth: 'bc1qr6vn5w2mxnm33cwtpm8tnvenvnwx4unu8szn0z',
      trx: '0xD2B475710CCd8a48B2fD20Ff7D8cd5360c428ba2',
      usdt_ethereum: 'TZ359zm5ixt1LcwSVZNErBGqqJujBhiX8e',
      usdt_tron: 'TRX7N2B475710CCd8a48B2fD20Ff7D8cd5360c428ba2'
    };

    // Image paths for cryptocurrencies
    const cryptoImagePaths = {
      btc: '/Public/btc.png',
      eth: '/Public/eth.png',
      trx: '/Public/trx.png',
      usdt_ethereum: '/Public/usdt-eth.png',
      usdt_tron: '/Public/usdt-tron.png',
      default: '/Public/mainl-logo.png' // Fallback image
    };

    // Mock Data
    const mockAssets = [
      { symbol: 'BTC', name: 'Bitcoin', balance: 0.5234, price: 45234.67, change: 2.34, iconClass: 'crypto-icon-bitcoin' },
      { symbol: 'ETH', name: 'Ethereum', balance: 12.8456, price: 2834.12, change: -1.23, iconClass: 'crypto-icon-ethereum' },
      { symbol: 'BNB', name: 'BNB', balance: 45.2341, price: 312.45, change: 5.67, iconClass: 'crypto-icon-bnb' },
      { symbol: 'USDT', name: 'Tether', balance: 1000.00, price: 1.00, change: 0.01, iconClass: 'crypto-icon-usdt' },
      { symbol: 'SOL', name: 'Solana', balance: 25.1234, price: 98.76, change: 8.45, iconClass: 'crypto-icon-solana' },
      { symbol: 'DOGE', name: 'Dogecoin', balance: 5000.00, price: 0.08, change: -3.21, iconClass: 'crypto-icon-doge' }
    ];

    const mockTransactions = [
      { type: 'receive', asset: 'BTC', amount: 0.1234, value: 5580.45, status: 'completed', time: '2 hours ago', hash: '0x1a2b3c...' },
      { type: 'send', asset: 'ETH', amount: 2.5, value: 7085.30, status: 'completed', time: '5 hours ago', hash: '0x4d5e6f...' },
      { type: 'buy', asset: 'BNB', amount: 10.0, value: 3124.50, status: 'pending', time: '1 day ago', hash: '0x7g8h9i...' },
      { type: 'swap', asset: 'USDT', amount: 500.0, value: 500.00, status: 'completed', time: '2 days ago', hash: '0xjklmno...' },
      { type: 'stake', asset: 'SOL', amount: 15.0, value: 1481.40, status: 'completed', time: '3 days ago', hash: '0xpqrstu...' }
    ];

    const mockPortfolioAssets = [
      { symbol: 'BTC', name: 'Bitcoin', balance: 0.5234, value: 23680.45, allocation: 44.8, change: 2.34, iconClass: 'crypto-icon-bitcoin' },
      { symbol: 'ETH', name: 'Ethereum', balance: 12.8456, value: 36380.12, allocation: 27.5, change: -1.23, iconClass: 'crypto-icon-ethereum' },
      { symbol: 'BNB', name: 'BNB', balance: 45.2341, value: 14140.50, allocation: 10.7, change: 5.67, iconClass: 'crypto-icon-bnb' },
      { symbol: 'USDT', name: 'Tether', balance: 1000.00, price: 1.00, value: 1000.00, allocation: 7.6, change: 0.01, iconClass: 'crypto-icon-usdt' },
      { symbol: 'SOL', name: 'Solana', balance: 25.1234, price: 98.76, value: 2481.40, allocation: 4.7, change: 8.45, iconClass: 'crypto-icon-solana' },
      { symbol: 'DOGE', name: 'Dogecoin', balance: 5000.00, price: 0.08, value: 400.00, allocation: 0.8, change: -3.21, iconClass: 'crypto-icon-doge' }
    ];

    const mockOrderBook = [
      { price: 45235.0, amount: 0.05, type: "buy" },
      { price: 45234.8, amount: 0.12, type: "buy" },
      { price: 45234.6, amount: 0.08, type: "buy" },
      { price: 45234.4, amount: 0.2, type: "buy" },
      { price: 45234.2, amount: 0.03, type: "buy" },
      { price: 45235.2, amount: 0.07, type: "sell" },
      { price: 45235.4, amount: 0.15, type: "sell" },
      { price: 45235.6, amount: 0.09, type: "sell" },
      { price: 45235.8, amount: 0.18, type: "sell" },
      { price: 45236.0, amount: 0.04, type: "sell" },
    ];

    const mockRecentTrades = [
      { time: "10:30:05", price: 45234.8, amount: 0.05, type: "buy" },
      { time: "10:30:02", price: 45235.1, amount: 0.1, type: "sell" },
      { time: "10:29:58", price: 45234.9, amount: 0.08, type: "buy" },
      { time: "10:29:55", price: 45235.0, amount: 0.12, type: "sell" },
      { time: "10:29:50", price: 45234.7, amount: 0.03, type: "buy" },
    ];

    const mockStakingOptions = [
      {
        asset: "Ethereum (ETH)",
        apy: "4.5%",
        minStake: "0.1 ETH",
        lockup: "7 days",
        iconClass: "crypto-icon-ethereum",
      },
      {
        asset: "Solana (SOL)",
        apy: "6.2%",
        minStake: "1 SOL",
        lockup: "3 days",
        iconClass: "crypto-icon-solana",
      },
      {
        asset: "BNB (BNB)",
        apy: "3.8%",
        minStake: "0.5 BNB",
        lockup: "14 days",
        iconClass: "crypto-icon-bnb",
      },
    ];

    // Initialize dashboard
    function initializeDashboard() {
      loadUserProfile();
      setupEventListeners();
      setupNavigation();
      setupModals();
      initializeChart();
      loadDashboardContent();
      loadPortfolioContent();
      loadTradingContent();
      loadTransactionsContent();
      loadStakingContent();
      loadSettingsContent();
    }

    // Load user profile from localStorage and Firebase
    async function loadUserProfile() {
      try {
        const storedUser = localStorage.getItem('safvacut_user');
        const authTime = localStorage.getItem('safvacut_auth_time');

        if (storedUser && authTime) {
          const userData = JSON.parse(storedUser);
          const timeDiff = Date.now() - parseInt(authTime);

          if (timeDiff < 3600000) { // Data less than 1 hour old
            currentUser = userData;
            userProfile = userData;
            updateUIWithUserData(userData);
            return;
          }
        }

        // If no valid localStorage data, check Firebase auth state
        onAuthStateChanged(auth, async (user) => {
          if (user) {
            currentUser = user;
            const userDocRef = doc(db, "users", user.uid);
            const userDocSnap = await getDoc(userDocRef);

            if (userDocSnap.exists()) {
              userProfile = userDocSnap.data();
            } else {
              // If no profile in Firestore, use basic user data
              userProfile = {
                displayName: user.displayName,
                email: user.email,
                photoURL: user.photoURL,
                uid: user.uid
              };
            }

            localStorage.setItem('safvacut_user', JSON.stringify(userProfile));
            localStorage.setItem('safvacut_auth_time', Date.now().toString());
            updateUIWithUserData(userProfile);
          } else {
            console.log('No valid user data found, redirecting to auth');
            window.location.href = 'auth.html';
          }
        });
      } catch (error) {
        console.error('Error loading user profile:', error);
        window.location.href = 'auth.html';
      }
    }

    // Update UI with user data
    function updateUIWithUserData(userData) {
      const userName = userData.displayName || userData.email.split('@')[0];
      const userEmail = userData.email;
      const userAvatar = userData.photoURL || `/placeholder.svg?height=40&width=40&query=${(userData.displayName || userData.email).charAt(0).toUpperCase()}`;

      document.getElementById('user-name').textContent = userName;
      document.getElementById('user-email').textContent = userEmail;
      document.getElementById('header-user-name').textContent = userName;
      document.getElementById('user-avatar').src = userAvatar;

      const settingsNameInput = document.getElementById('settings-name');
      const settingsEmailInput = document.getElementById('settings-email');
      if (settingsNameInput) settingsNameInput.value = userData.displayName || '';
      if (settingsEmailInput) settingsEmailInput.value = userData.email || '';
    }

    // Load dashboard content
    function loadDashboardContent() {
      const assetsList = document.getElementById('assets-list');
      const transactionsList = document.getElementById('transactions-list');
      const marketOverview = document.getElementById('market-overview');

      if (assetsList) {
        assetsList.innerHTML = '';
        mockAssets.slice(0, 6).forEach(asset => {
          const value = asset.balance * asset.price;
          const changeClass = asset.change >= 0 ? 'price-up' : 'price-down';
          const changeIcon = asset.change >= 0 ? '↗' : '↘';

          assetsList.innerHTML += `
            <div class="crypto-item flex items-center justify-between p-3 sm:p-4 glass-effect rounded-xl crypto-card">
              <div class="flex items-center space-x-3">
                <div class="crypto-icon w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${asset.iconClass}">
                  <span class="text-white font-bold text-xs sm:text-sm">${asset.symbol.charAt(0)}</span>
                </div>
                <div>
                  <div class="crypto-text font-medium text-sm sm:text-base">${asset.name}</div>
                  <div class="crypto-text text-xs sm:text-sm text-gray-400">${asset.balance.toFixed(4)} ${asset.symbol}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="crypto-price font-medium calculator-font text-sm sm:text-base">$${value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                <div class="text-xs sm:text-sm ${changeClass}">${changeIcon} ${Math.abs(asset.change).toFixed(2)}%</div>
              </div>
            </div>
          `;
        });
      }

      if (transactionsList) {
        transactionsList.innerHTML = '';
        mockTransactions.slice(0, 5).forEach(tx => {
          const statusClass = `status-${tx.status}`;
          const typeIcon = getTransactionIcon(tx.type);
          const typeColor = getTransactionColor(tx.type);

          transactionsList.innerHTML += `
            <div class="transaction-item flex items-center justify-between p-3 sm:p-4 glass-effect rounded-xl">
              <div class="flex items-center space-x-3">
                <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${typeColor}">
                  ${typeIcon}
                </div>
                <div>
                  <div class="font-medium capitalize text-sm sm:text-base">${tx.type} ${tx.asset}</div>
                  <div class="text-xs sm:text-sm text-gray-400">${tx.time}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-medium calculator-font text-sm sm:text-base">${tx.type === 'send' ? '-' : '+'}${tx.amount} ${tx.asset}</div>
                <div class="text-xs sm:text-sm ${statusClass} px-2 py-1 rounded-full">${tx.status}</div>
              </div>
            </div>
          `;
        });
      }

      if (marketOverview) {
        marketOverview.innerHTML = '';
        mockAssets.slice(0, 4).forEach(asset => {
          const changeClass = asset.change >= 0 ? 'price-up' : 'price-down';
          const changeIcon = asset.change >= 0 ? '↗' : '↘';

          marketOverview.innerHTML += `
            <div class="glass-effect rounded-xl p-3 sm:p-4 crypto-card">
              <div class="flex items-center space-x-3 mb-3">
                <div class="crypto-icon w-6 h-6 sm:w-8 sm:h-8 rounded-full flex items-center justify-center ${asset.iconClass}">
                  <span class="text-white font-bold text-xs">${asset.symbol.charAt(0)}</span>
                </div>
                <div>
                  <div class="font-medium text-sm sm:text-base">${asset.symbol}</div>
                  <div class="text-xs text-gray-400">${asset.name}</div>
                </div>
              </div>
              <div class="text-base sm:text-lg font-bold mb-1 calculator-font">$${asset.price.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
              <div class="text-xs sm:text-sm ${changeClass}">${changeIcon} ${Math.abs(asset.change).toFixed(2)}%</div>
            </div>
          `;
        });
      }

      const totalBalance = mockAssets.reduce((sum, asset) => sum + asset.balance * asset.price, 0);
      const balanceChange = mockAssets.reduce((sum, asset) => sum + asset.balance * asset.price * (asset.change / 100), 0);
      const balanceChangePercentage = (balanceChange / (totalBalance - balanceChange)) * 100;

      document.getElementById('total-balance').textContent = totalBalance.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 });

      const balanceChangeElement = document.getElementById('balance-change');
      if (balanceChangeElement) {
        balanceChangeElement.textContent = `${balanceChange >= 0 ? '+' : '-'}$${Math.abs(balanceChange).toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} (${balanceChangePercentage.toFixed(2)}%)`;
        balanceChangeElement.className = `text-xs sm:text-sm font-medium ${balanceChange >= 0 ? 'price-up' : 'price-down'}`;
      }
    }

    // Load portfolio content
    function loadPortfolioContent() {
      const portfolioAssetsList = document.getElementById('portfolio-assets-list');
      if (portfolioAssetsList) {
        portfolioAssetsList.innerHTML = '';
        mockPortfolioAssets.forEach(asset => {
          const changeClass = asset.change >= 0 ? 'price-up' : 'price-down';
          const changeIcon = asset.change >= 0 ? '↗' : '↘';

          portfolioAssetsList.innerHTML += `
            <div class="flex items-center justify-between p-3 sm:p-4 glass-effect rounded-xl crypto-card">
              <div class="flex items-center space-x-3">
                <div class="crypto-icon w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${asset.iconClass}">
                  <span class="text-white font-bold text-xs sm:text-sm">${asset.symbol.charAt(0)}</span>
                </div>
                <div>
                  <div class="font-medium text-sm sm:text-base">${asset.name}</div>
                  <div class="text-xs sm:text-sm text-gray-400">${asset.balance.toFixed(4)} ${asset.symbol}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-medium calculator-font text-sm sm:text-base">$${asset.value.toLocaleString('en-US', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</div>
                <div class="text-xs sm:text-sm text-gray-400">${asset.allocation}%</div>
                <div class="text-xs sm:text-sm ${changeClass}">${changeIcon} ${Math.abs(asset.change).toFixed(2)}%</div>
              </div>
            </div>
          `;
        });
      }
    }

    // Load trading content
    function loadTradingContent() {
      const orderBookSells = document.getElementById('order-book-sells');
      const orderBookBuys = document.getElementById('order-book-buys');
      const recentTradesList = document.getElementById('recent-trades-list');

      if (orderBookSells) {
        orderBookSells.innerHTML = '';
        mockOrderBook.filter(order => order.type === 'sell').forEach(order => {
          orderBookSells.innerHTML += `
            <div class="flex justify-between text-xs sm:text-sm text-red-400">
              <span class="calculator-font">${order.price.toFixed(2)}</span>
              <span class="calculator-font">${order.amount.toFixed(4)}</span>
            </div>
          `;
        });
      }

      if (orderBookBuys) {
        orderBookBuys.innerHTML = '';
        mockOrderBook.filter(order => order.type === 'buy').forEach(order => {
          orderBookBuys.innerHTML += `
            <div class="flex justify-between text-xs sm:text-sm text-green-400">
              <span class="calculator-font">${order.price.toFixed(2)}</span>
              <span class="calculator-font">${order.amount.toFixed(4)}</span>
            </div>
          `;
        });
      }

      if (recentTradesList) {
        recentTradesList.innerHTML = '';
        mockRecentTrades.forEach(trade => {
          const priceClass = trade.type === 'buy' ? 'text-green-400' : 'text-red-400';
          recentTradesList.innerHTML += `
            <div class="flex justify-between text-xs sm:text-sm">
              <span class="text-gray-400">${trade.time}</span>
              <span class="${priceClass} calculator-font">${trade.price.toFixed(2)}</span>
              <span class="calculator-font">${trade.amount.toFixed(4)}</span>
            </div>
          `;
        });
      }
    }

    // Load transactions content
    function loadTransactionsContent() {
      const transactionHistory = document.getElementById('transaction-history');
      if (transactionHistory) {
        transactionHistory.innerHTML = '';
        mockTransactions.forEach(tx => {
          const statusClass = `status-${tx.status}`;
          const typeIcon = getTransactionIcon(tx.type);
          const typeColor = getTransactionColor(tx.type);

          transactionHistory.innerHTML += `
            <div class="transaction-item flex items-center justify-between p-3 sm:p-4 glass-effect rounded-xl">
              <div class="flex items-center space-x-3">
                <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${typeColor}">
                  ${typeIcon}
                </div>
                <div>
                  <div class="font-medium capitalize text-sm sm:text-base">${tx.type} ${tx.asset}</div>
                  <div class="text-xs sm:text-sm text-gray-400">${tx.time}</div>
                </div>
              </div>
              <div class="text-right">
                <div class="font-medium calculator-font text-sm sm:text-base">${tx.type === 'send' ? '-' : '+'}${tx.amount} ${tx.asset}</div>
                <div class="text-xs sm:text-sm ${statusClass} px-2 py-1 rounded-full">${tx.status}</div>
              </div>
            </div>
          `;
        });
      }
    }

    // Load staking content
    function loadStakingContent() {
      const stakingOptionsList = document.getElementById('staking-options-list');
      if (stakingOptionsList) {
        stakingOptionsList.innerHTML = '';
        mockStakingOptions.forEach(option => {
          stakingOptionsList.innerHTML += `
            <div class="glass-effect rounded-xl p-3 sm:p-4 crypto-card">
              <div class="flex items-center space-x-3 mb-3">
                <div class="crypto-icon w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${option.iconClass}">
                  <span class="text-white font-bold text-xs sm:text-sm">${option.asset.charAt(0)}</span>
                </div>
                <div class="font-medium text-sm sm:text-base">${option.asset}</div>
              </div>
              <div class="flex justify-between items-center mb-2">
                <span class="text-xs sm:text-sm text-gray-400">APY:</span>
                <span class="text-green-500 font-medium calculator-font text-sm sm:text-base">${option.apy}</span>
              </div>
              <div class="flex justify-between items-center mb-2">
                <span class="text-xs sm:text-sm text-gray-400">Min Stake:</span>
                <span class="font-medium calculator-font text-sm sm:text-base">${option.minStake}</span>
              </div>
              <div class="flex justify-between items-center mb-4">
                <span class="text-xs sm:text-sm text-gray-400">Lockup Period:</span>
                <span class="font-medium text-sm sm:text-base">${option.lockup}</span>
              </div>
              <button class="btn-primary w-full py-2 rounded-lg font-semibold text-sm sm:text-base">Stake Now</button>
            </div>
          `;
        });
      }
    }

    // Load settings content
    function loadSettingsContent() {
      const profileSettingsForm = document.getElementById('profile-settings-form');
      if (profileSettingsForm) {
        profileSettingsForm.addEventListener('submit', async (e) => {
          e.preventDefault();
          const displayName = document.getElementById('settings-name').value;

          try {
            if (currentUser) {
              await firebaseUpdateProfile(currentUser, { displayName });
              userProfile.displayName = displayName; // Update local profile
              localStorage.setItem('safvacut_user', JSON.stringify(userProfile));
              updateUIWithUserData(userProfile); // Refresh UI
              showToast('Profile updated successfully!', 'success');
            }
          } catch (error) {
            console.error('Error updating profile:', error);
            showToast('Failed to update profile.', 'error');
          }
        });
      }
    }

    // Helper functions for icons and colors
    function getTransactionIcon(type) {
      const icons = {
        send: '<svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>',
        receive: '<svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8l-8-8-8 8"></path></svg>',
        buy: '<svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg>',
        swap: '<svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>',
        stake: '<svg class="w-4 h-4 sm:w-5 sm:h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"></path></svg>'
      };
      return icons[type] || icons.send;
    }

    function getTransactionColor(type) {
      const colors = {
        send: 'bg-red-500 bg-opacity-20',
        receive: 'bg-green-500 bg-opacity-20',
        buy: 'bg-blue-500 bg-opacity-20',
        swap: 'bg-purple-500 bg-opacity-20',
        stake: 'bg-orange-500 bg-opacity-20'
      };
      return colors[type] || colors.send;
    }

    // Setup event listeners
    function setupEventListeners() {
      // Theme toggle
      document.getElementById('theme-toggle').addEventListener('click', toggleTheme);

      // Mobile menu toggle
      document.getElementById('mobile-menu-btn').addEventListener('click', toggleMobileMenu);
      document.getElementById('mobile-overlay').addEventListener('click', closeMobileMenu);

      // Logout
      document.getElementById('logout-btn').addEventListener('click', handleLogout);

      // Modal triggers
      window.showSendModal = () => showModal('send-modal');
      window.showReceiveModal = () => showModal('receive-modal');
      window.showBuyModal = () => showModal('buy-modal');
      window.showSwapModal = () => showModal('swap-modal');

      // Transaction filters
      document.getElementById('filter-transactions-btn').addEventListener('click', applyTransactionFilters);
    }

    // Setup navigation
    function setupNavigation() {
      const navItems = document.querySelectorAll('.nav-item[data-section]');
      const sections = document.querySelectorAll('.section-content');

      navItems.forEach(item => {
        item.addEventListener('click', (e) => {
          e.preventDefault();
          const targetSection = item.getAttribute('data-section');

          // Update active nav item
          document.querySelectorAll('.nav-item').forEach(nav => nav.classList.remove('active'));
          item.classList.add('active');

          // Show target section
          sections.forEach(section => section.classList.add('hidden'));
          document.getElementById(`${targetSection}-section`).classList.remove('hidden');

          // Close mobile menu if open
          closeMobileMenu();
        });
      });

      // Set initial active section based on URL hash or default to dashboard
      const initialSection = window.location.hash.substring(1) || 'dashboard';
      const initialNavItem = document.querySelector(`[data-section="${initialSection}"]`);
      if (initialNavItem) {
        initialNavItem.click(); // Simulate click to activate and show section
      } else {
        document.querySelector('[data-section="dashboard"]').click();
      }
    }

    // Setup modals
    function setupModals() {
      const modals = document.querySelectorAll('.modal');
      const closeButtons = document.querySelectorAll('.close-modal');

      closeButtons.forEach(button => {
        button.addEventListener('click', () => {
          const modal = button.closest('.modal');
          modal.classList.remove('active');
        });
      });

      modals.forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            modal.classList.remove('active');
          }
        });
      });

      // Setup specific modal logic
      setupSendModal();
      setupReceiveModal();
    }

    // Setup send modal
    function setupSendModal() {
      const sendAssetSelect = document.getElementById('send-asset');
      const sendCryptoLogo = document.getElementById('send-crypto-logo');

      function updateSendModalImage() {
        const selectedAsset = sendAssetSelect.value;
        sendCryptoLogo.src = cryptoImagePaths[selectedAsset] || cryptoImagePaths.default;
      }

      sendAssetSelect.addEventListener('change', updateSendModalImage);
      // Initialize with default image
      updateSendModalImage();
    }

    // Setup receive modal
    function setupReceiveModal() {
      const receiveAsset = document.getElementById('receive-asset');
      const receiveAddress = document.getElementById('receive-address');
      const receiveQR = document.getElementById('receive-qr');
      const copyAddressBtn = document.getElementById('copy-address');
      const shareAddressBtn = document.getElementById('share-address');
      const receiveCryptoLogo = document.getElementById('receive-crypto-logo');

      function updateReceiveAddress() {
        const selectedAsset = receiveAsset.value;
        const address = walletAddresses[selectedAsset] || walletAddresses.btc;
        const logoUrl = cryptoImagePaths[selectedAsset] || cryptoImagePaths.default;

        receiveAddress.textContent = address;
        receiveCryptoLogo.src = logoUrl;

        // Generate QR code
        QRCode.toCanvas(receiveQR, address, {
          width: 200,
          margin: 2,
          color: {
            dark: '#000000',
            light: '#FFFFFF'
          }
        });
      }

      receiveAsset.addEventListener('change', updateReceiveAddress);

      copyAddressBtn.addEventListener('click', () => {
        navigator.clipboard.writeText(receiveAddress.textContent).then(() => {
          showToast('Address copied to clipboard!', 'success');
        });
      });

      shareAddressBtn.addEventListener('click', () => {
        if (navigator.share) {
          navigator.share({
            title: 'Safvacut Wallet Address',
            text: receiveAddress.textContent
          });
        } else {
          navigator.clipboard.writeText(receiveAddress.textContent).then(() => {
            showToast('Address copied for sharing!', 'info');
          });
        }
      });

      // Initialize with default address and image
      updateReceiveAddress();
    }

    // Initialize chart
    function initializeChart() {
      const ctx = document.getElementById('portfolio-chart');
      if (ctx) {
        if (portfolioChartInstance) {
          portfolioChartInstance.destroy(); // Destroy existing chart instance
        }

        portfolioChartInstance = new Chart(ctx, {
          type: 'line',
          data: {
            labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
            datasets: [{
              label: 'Portfolio Value',
              data: [30000, 35000, 32000, 45000, 48000, 52847],
              borderColor: '#f7931e',
              backgroundColor: 'rgba(247, 147, 30, 0.1)',
              borderWidth: 2,
              fill: true,
              tension: 0.4
            }]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              legend: {
                display: false
              }
            },
            scales: {
              x: {
                display: false
              },
              y: {
                display: false
              }
            },
            elements: {
              point: {
                radius: 0
              }
            }
          }
        });
      }
    }

    // Apply transaction filters
    function applyTransactionFilters() {
      const typeFilter = document.getElementById('transaction-type-filter').value;
      const assetFilter = document.getElementById('transaction-asset-filter').value;
      const dateFilter = document.getElementById('transaction-date-filter').value;
      const transactionHistory = document.getElementById('transaction-history');

      if (!transactionHistory) return;

      transactionHistory.innerHTML = ''; // Clear current list

      const filteredTransactions = mockTransactions.filter(tx => {
        const matchesType = typeFilter === 'All Types' || tx.type === typeFilter.toLowerCase();
        const matchesAsset = assetFilter === 'All Assets' || tx.asset === assetFilter;
        const matchesDate = !dateFilter || tx.time.startsWith(dateFilter); // Simple date match

        return matchesType && matchesAsset && matchesDate;
      });

      if (filteredTransactions.length === 0) {
        transactionHistory.innerHTML = '<p class="text-center text-gray-400 py-4">No transactions found for the selected filters.</p>';
        return;
      }

      filteredTransactions.forEach(tx => {
        const statusClass = `status-${tx.status}`;
        const typeIcon = getTransactionIcon(tx.type);
        const typeColor = getTransactionColor(tx.type);

        transactionHistory.innerHTML += `
          <div class="transaction-item flex items-center justify-between p-3 sm:p-4 glass-effect rounded-xl">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 sm:w-10 sm:h-10 rounded-full flex items-center justify-center ${typeColor}">
                ${typeIcon}
              </div>
              <div>
                <div class="font-medium capitalize text-sm sm:text-base">${tx.type} ${tx.asset}</div>
                <div class="text-xs sm:text-sm text-gray-400">${tx.time}</div>
              </div>
            </div>
            <div class="text-right">
              <div class="font-medium calculator-font text-sm sm:text-base">${tx.type === 'send' ? '-' : '+'}${tx.amount} ${tx.asset}</div>
              <div class="text-xs sm:text-sm ${statusClass} px-2 py-1 rounded-full">${tx.status}</div>
            </div>
          </div>
        `;
      });
    }

    // Utility functions
    function showModal(modalId) {
      document.getElementById(modalId).classList.add('active');
    }

    function toggleTheme() {
      const body = document.body;
      const themeIconDark = document.getElementById('theme-icon-dark');
      const themeIconLight = document.getElementById('theme-icon-light');

      if (body.classList.contains('dark')) {
        body.classList.remove('dark', 'dark-theme');
        body.classList.add('light', 'light-theme');
        themeIconDark.classList.remove('hidden');
        themeIconLight.classList.add('hidden');
        localStorage.setItem('theme', 'light');
      } else {
        body.classList.remove('light', 'light-theme');
        body.classList.add('dark', 'dark-theme');
        themeIconDark.classList.add('hidden');
        themeIconLight.classList.remove('hidden');
        localStorage.setItem('theme', 'dark');
      }
    }

    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('mobile-overlay');
      sidebar.classList.toggle('sidebar-open');
      overlay.classList.toggle('active');
    }

    function closeMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      const overlay = document.getElementById('mobile-overlay');
      sidebar.classList.remove('sidebar-open');
      overlay.classList.remove('active');
    }

    function showToast(message, type = 'success') {
      Swal.fire({
        toast: true,
        position: 'top-end',
        showConfirmButton: false,
        timer: 3000,
        timerProgressBar: true,
        icon: type,
        title: message,
        background: 'rgba(15, 15, 35, 0.9)',
        color: '#ffffff',
        iconColor: type === 'success' ? '#10b981' : (type === 'error' ? '#ef4444' : '#f59e0b')
      });
    }

    async function handleLogout() {
      try {
        await signOut(auth);
        localStorage.removeItem('safvacut_user');
        localStorage.removeItem('safvacut_auth_time');
        window.location.href = 'auth.html';
      } catch (error) {
        console.error('Logout error:', error);
        showToast('Error signing out', 'error');
      }
    }

    // Check authentication state on page load
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        // Clear localStorage and redirect if no authenticated user
        localStorage.removeItem('safvacut_user');
        localStorage.removeItem('safvacut_auth_time');
        if (window.location.pathname !== '/auth.html') {
          window.location.href = 'auth.html';
        }
      }
    });

    // Initialize dashboard when DOM is loaded
    document.addEventListener('DOMContentLoaded', () => {
      initializeDashboard();

      // Load saved theme
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'light') {
        document.body.classList.remove('dark', 'dark-theme');
        document.body.classList.add('light', 'light-theme');
        document.getElementById('theme-icon-dark').classList.remove('hidden');
        document.getElementById('theme-icon-light').classList.add('hidden');
      } else {
        document.body.classList.remove('light', 'light-theme');
        document.body.classList.add('dark', 'dark-theme');
        document.getElementById('theme-icon-dark').classList.add('hidden');
        document.getElementById('theme-icon-light').classList.remove('hidden');
      }
    });
  </script>
</body>

</html>
